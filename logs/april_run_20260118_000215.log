2026-01-18 00:02:35,351 - INFO - outputs shape: torch.Size([2, 10]), dtype: torch.float32
2026-01-18 00:02:35,351 - INFO - labels shape: torch.Size([2]), dtype: torch.int64
2026-01-18 00:02:35,467 - INFO - Shape of input_embedding_grad: torch.Size([1, 197, 192])
2026-01-18 00:02:35,478 - INFO - Range of input_embedding_grad: min=-0.0005, max=0.0005
2026-01-18 00:02:35,478 - INFO - 
--- APRIL Algorithm ---
2026-01-18 00:02:35,484 - INFO - q_weights range: min=-0.0722, max=0.0722
2026-01-18 00:02:35,485 - INFO - k_weights range: min=-0.0722, max=0.0722
2026-01-18 00:02:35,485 - INFO - v_weights range: min=-0.0722, max=0.0722
2026-01-18 00:02:35,486 - INFO - dldq range: min=-0.0030, max=0.0024
2026-01-18 00:02:35,486 - INFO - dldk range: min=-0.0038, max=0.0041
2026-01-18 00:02:35,487 - INFO - dldv range: min=-0.0924, max=0.0839
2026-01-18 00:02:35,487 - INFO - dldz range: min=-0.0005, max=0.0005
2026-01-18 00:02:35,491 - INFO - shape of A: torch.Size([192, 192]), range: min=-0.0020, max=0.0018
2026-01-18 00:02:35,491 - INFO - shape of B: torch.Size([192, 192]), range: min=-0.0025, max=0.0023
2026-01-18 00:02:35,492 - INFO - shape of C: torch.Size([192, 192]), range: min=-0.0576, max=0.0521
2026-01-18 00:02:35,492 - INFO - shape of RHS sum: torch.Size([192, 192])
2026-01-18 00:02:35,493 - INFO - RHS sum range: min=-0.0576, max=0.0521
2026-01-18 00:02:35,523 - INFO - Shape of pseudo-inverse of A: torch.Size([192, 197])
2026-01-18 00:02:35,527 - INFO - A_pinv range: min=-76245.7969, max=84508.8516
2026-01-18 00:02:35,529 - INFO - Shape of reconstructed z: torch.Size([197, 192])
2026-01-18 00:02:35,533 - INFO - z_reconstructed range: min=-11027.4326, max=11911.9688
2026-01-18 00:02:35,533 - INFO - 
--- Patch Embedding Reconstruction Results ---
2026-01-18 00:02:35,533 - INFO - Original embedding shape: torch.Size([2, 197, 192])
2026-01-18 00:02:35,533 - INFO - Reconstructed embedding shape: torch.Size([1, 197, 192])
2026-01-18 00:02:35,537 - INFO - Reconstruction error: 365581.875
2026-01-18 00:02:35,538 - INFO - 
--- Embedding Visualization ---
2026-01-18 00:02:35,541 - INFO - Original embedding norm shape: (196,)
2026-01-18 00:02:35,541 - INFO - Reconstructed embedding norm shape: (196,)
2026-01-18 00:02:35,744 - INFO - Saved embedding visualization to embedding_visualization.png
2026-01-18 00:02:35,744 - INFO - 
--- Image Patch Reconstruction ---
2026-01-18 00:02:35,744 - INFO - Shape of positional embedding: torch.Size([1, 197, 192])
2026-01-18 00:02:35,746 - INFO - Range of positional embedding: min=-0.0752, max=0.0879
2026-01-18 00:02:35,746 - INFO - Shape of patch embeddings (z_patch): torch.Size([2, 196, 192])
2026-01-18 00:02:35,758 - INFO - Range of patch embeddings (z_patch): min=-2.9012, max=2.4887
2026-01-18 00:02:35,784 - INFO - Shape of pseudo-inverse of projection matrix: torch.Size([192, 768])
2026-01-18 00:02:35,786 - INFO - Shape of flattened reconstructed patches: torch.Size([2, 196, 768])
2026-01-18 00:02:35,793 - INFO - 
Reconstruction error for the first patch: 16.84632682800293
2026-01-18 00:02:35,793 - INFO - Shape of original patch: torch.Size([3, 16, 16])
2026-01-18 00:02:35,793 - INFO - Shape of reconstructed patch: torch.Size([3, 16, 16])
2026-01-18 00:02:35,793 - INFO - 
--- Full Image Reconstruction Visualization ---
