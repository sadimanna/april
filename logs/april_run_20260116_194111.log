2026-01-16 19:41:12,612 - INFO - Loading pretrained weights from Hugging Face hub (timm/vit_tiny_patch16_224.augreg_in21k_ft_in1k)
2026-01-16 19:41:22,693 - WARNING - '(ReadTimeoutError("HTTPSConnectionPool(host='huggingface.co', port=443): Read timed out. (read timeout=10)"), '(Request ID: 5abcafb6-a20d-4979-98fb-b17df4a3dce4)')' thrown while requesting HEAD https://huggingface.co/timm/vit_tiny_patch16_224.augreg_in21k_ft_in1k/resolve/main/model.safetensors
2026-01-16 19:41:22,694 - WARNING - Retrying in 1s [Retry 1/5].
2026-01-16 19:41:27,375 - INFO - [timm/vit_tiny_patch16_224.augreg_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2026-01-16 19:41:57,349 - INFO - outputs shape: torch.Size([2, 10]), dtype: torch.float32
2026-01-16 19:41:57,350 - INFO - labels shape: torch.Size([2]), dtype: torch.int64
2026-01-16 19:41:57,488 - INFO - Shape of input_embedding_grad: torch.Size([1, 197, 192])
2026-01-16 19:41:57,499 - INFO - Range of input_embedding_grad: min=-0.1738, max=0.1690
2026-01-16 19:41:57,499 - INFO - 
--- APRIL Algorithm ---
2026-01-16 19:41:57,505 - INFO - q_weights range: min=-0.3756, max=0.3811
2026-01-16 19:41:57,505 - INFO - k_weights range: min=-0.3984, max=0.3901
2026-01-16 19:41:57,506 - INFO - v_weights range: min=-0.3485, max=0.3787
2026-01-16 19:41:57,506 - INFO - dldq range: min=-0.2582, max=0.2612
2026-01-16 19:41:57,507 - INFO - dldk range: min=-0.9596, max=0.9937
2026-01-16 19:41:57,507 - INFO - dldv range: min=-0.9414, max=0.8724
2026-01-16 19:41:57,508 - INFO - dldz range: min=-0.1738, max=0.1690
2026-01-16 19:41:57,511 - INFO - shape of A: torch.Size([192, 192]), range: min=-0.4208, max=0.4328
2026-01-16 19:41:57,512 - INFO - shape of B: torch.Size([192, 192]), range: min=-0.6262, max=0.6276
2026-01-16 19:41:57,512 - INFO - shape of C: torch.Size([192, 192]), range: min=-0.5795, max=0.6529
2026-01-16 19:41:57,512 - INFO - shape of RHS sum: torch.Size([192, 192])
2026-01-16 19:41:57,513 - INFO - RHS sum range: min=-0.8095, max=0.6512
2026-01-16 19:41:57,564 - INFO - Shape of pseudo-inverse of A: torch.Size([192, 197])
2026-01-16 19:41:57,568 - INFO - A_pinv range: min=-6053.9136, max=6317.7305
2026-01-16 19:41:57,570 - INFO - Shape of reconstructed z: torch.Size([197, 192])
2026-01-16 19:41:57,575 - INFO - z_reconstructed range: min=-9039.3965, max=10466.1602
2026-01-16 19:41:57,575 - INFO - 
--- Patch Embedding Reconstruction Results ---
2026-01-16 19:41:57,575 - INFO - Original embedding shape: torch.Size([2, 197, 192])
2026-01-16 19:41:57,575 - INFO - Reconstructed embedding shape: torch.Size([1, 197, 192])
2026-01-16 19:41:57,580 - INFO - Reconstruction error: 311169.375
2026-01-16 19:41:57,580 - INFO - 
--- Embedding Visualization ---
2026-01-16 19:41:57,587 - INFO - Original embedding norm shape: (196,)
2026-01-16 19:41:57,587 - INFO - Reconstructed embedding norm shape: (196,)
2026-01-16 19:41:57,853 - INFO - Saved embedding visualization to embedding_visualization.png
2026-01-16 19:41:57,853 - INFO - 
--- Image Patch Reconstruction ---
2026-01-16 19:41:57,854 - INFO - Shape of positional embedding: torch.Size([1, 197, 192])
2026-01-16 19:41:57,855 - INFO - Range of positional embedding: min=-5.4653, max=3.8469
2026-01-16 19:41:57,856 - INFO - Shape of patch embeddings (z_patch): torch.Size([2, 196, 192])
2026-01-16 19:41:57,876 - INFO - Range of patch embeddings (z_patch): min=-16.7937, max=13.6277
2026-01-16 19:41:57,905 - INFO - Shape of pseudo-inverse of projection matrix: torch.Size([192, 768])
2026-01-16 19:41:57,910 - INFO - Shape of flattened reconstructed patches: torch.Size([2, 196, 768])
2026-01-16 19:41:57,913 - INFO - 
Reconstruction error for the first patch: 50.032161712646484
2026-01-16 19:41:57,913 - INFO - Shape of original patch: torch.Size([3, 16, 16])
2026-01-16 19:41:57,913 - INFO - Shape of reconstructed patch: torch.Size([3, 16, 16])
2026-01-16 19:41:57,913 - INFO - 
--- Full Image Reconstruction Visualization ---
