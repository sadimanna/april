2026-01-20 17:10:03,693 - INFO - Dataset is cifar10, using vit_small_cifar
2026-01-20 17:10:04,200 - INFO - outputs shape: torch.Size([2, 10]), dtype: torch.float32
2026-01-20 17:10:04,200 - INFO - labels shape: torch.Size([2]), dtype: torch.int64
2026-01-20 17:10:04,219 - INFO - Shape of input_embedding_grad: torch.Size([2, 197, 384])
2026-01-20 17:10:04,234 - INFO - Range of input_embedding_grad: min=-0.0004, max=0.0004
2026-01-20 17:10:04,358 - INFO - --- APRIL Algorithm ---
2026-01-20 17:10:04,359 - INFO - q_weights range: min=-0.0524, max=0.0523
2026-01-20 17:10:04,359 - INFO - k_weights range: min=-0.0523, max=0.0524
2026-01-20 17:10:04,359 - INFO - v_weights range: min=-0.0524, max=0.0523
2026-01-20 17:10:04,359 - INFO - dldq range: min=0.0000, max=0.0000
2026-01-20 17:10:04,359 - INFO - dldk range: min=0.0000, max=0.0000
2026-01-20 17:10:04,359 - INFO - dldv range: min=0.0000, max=0.0000
2026-01-20 17:10:04,359 - INFO - dldz range: min=-0.0004, max=0.0004
2026-01-20 17:10:04,360 - INFO - shape of A: torch.Size([384, 384]), range: min=0.0000, max=0.0000
2026-01-20 17:10:04,360 - INFO - shape of B: torch.Size([384, 384]), range: min=0.0000, max=0.0000
2026-01-20 17:10:04,360 - INFO - shape of C: torch.Size([384, 384]), range: min=0.0000, max=0.0000
2026-01-20 17:10:04,360 - INFO - shape of RHS sum: torch.Size([384, 384])
2026-01-20 17:10:04,360 - INFO - RHS sum range: min=0.0000, max=0.0000
2026-01-20 17:10:04,556 - INFO - Shape of pseudo-inverse of A: torch.Size([384, 394])
2026-01-20 17:10:04,557 - INFO - A_pinv range: min=-36056.3828, max=30624.6953
2026-01-20 17:10:04,557 - INFO - Shape of reconstructed z: torch.Size([394, 384])
2026-01-20 17:10:04,557 - INFO - z_reconstructed range: min=0.0000, max=0.0000
2026-01-20 17:10:04,557 - INFO - --- Patch Embedding Reconstruction Results ---
2026-01-20 17:10:04,557 - INFO - Original embedding shape: torch.Size([2, 197, 384])
2026-01-20 17:10:04,557 - INFO - Reconstructed embedding shape: torch.Size([2, 197, 384])
2026-01-20 17:10:04,575 - INFO - Reconstruction error: 210.23272705078125
2026-01-20 17:10:04,575 - INFO - --- Embedding Visualization ---
2026-01-20 17:10:04,576 - INFO - Original embedding norm shape: (196,)
2026-01-20 17:10:04,576 - INFO - Reconstructed embedding norm shape: (196,)
2026-01-20 17:10:04,818 - INFO - Saved embedding visualization to embedding_visualization.png
2026-01-20 17:10:04,819 - INFO - --- Image Patch Reconstruction ---
2026-01-20 17:10:04,819 - INFO - Shape of positional embedding: torch.Size([1, 197, 384])
2026-01-20 17:10:04,819 - INFO - Range of positional embedding: min=-0.0874, max=0.0817
2026-01-20 17:10:04,819 - INFO - Shape of patch embeddings (z_patch): torch.Size([2, 196, 384])
2026-01-20 17:10:04,819 - INFO - Range of patch embeddings (z_patch): min=-4.5975, max=3.9380
2026-01-20 17:10:04,843 - INFO - Shape of pseudo-inverse of projection matrix: torch.Size([384, 768])
2026-01-20 17:10:04,843 - INFO - Shape of flattened reconstructed patches: torch.Size([2, 196, 768])
2026-01-20 17:10:04,843 - INFO - Reconstruction error for the first patch: 6.8191962242126465
2026-01-20 17:10:04,844 - INFO - Shape of original patch: torch.Size([3, 16, 16])
2026-01-20 17:10:04,844 - INFO - Shape of reconstructed patch: torch.Size([3, 16, 16])
2026-01-20 17:10:04,844 - INFO - --- Full Image Reconstruction Visualization ---
