2026-01-20 17:20:25,588 - INFO - APRIL Mode: APRIL with LoRA (Rank: 4)
2026-01-20 17:20:26,238 - INFO - Dataset is cifar10, using vit_small_cifar
2026-01-20 17:20:26,238 - INFO - Model Options: LoRA Rank=4, LN=False, Res=False
2026-01-20 17:20:26,805 - INFO - outputs shape: torch.Size([2, 10]), dtype: torch.float32
2026-01-20 17:20:26,805 - INFO - labels shape: torch.Size([2]), dtype: torch.int64
2026-01-20 17:20:26,826 - INFO - Shape of input_embedding_grad: torch.Size([2, 197, 384])
2026-01-20 17:20:26,841 - INFO - Range of input_embedding_grad: min=-0.0006, max=0.0007
2026-01-20 17:20:27,002 - INFO - --- APRIL Algorithm ---
2026-01-20 17:20:27,002 - INFO - --- APRIL Algorithm ---
2026-01-20 17:20:27,002 - INFO - q_weights range: min=-0.0523, max=0.0523
2026-01-20 17:20:27,003 - INFO - k_weights range: min=-0.0523, max=0.0524
2026-01-20 17:20:27,003 - INFO - v_weights range: min=-0.0523, max=0.0524
2026-01-20 17:20:27,004 - INFO - dldq range: min=0.0000, max=0.0000
2026-01-20 17:20:27,004 - INFO - dldk range: min=0.0000, max=0.0000
2026-01-20 17:20:27,004 - INFO - dldv range: min=0.0000, max=0.0000
2026-01-20 17:20:27,004 - INFO - dldz range: min=-0.0006, max=0.0007
2026-01-20 17:20:27,005 - INFO - shape of A: torch.Size([384, 384]), range: min=0.0000, max=0.0000
2026-01-20 17:20:27,005 - INFO - shape of B: torch.Size([384, 384]), range: min=0.0000, max=0.0000
2026-01-20 17:20:27,005 - INFO - shape of C: torch.Size([384, 384]), range: min=0.0000, max=0.0000
2026-01-20 17:20:27,005 - INFO - shape of RHS sum: torch.Size([384, 384])
2026-01-20 17:20:27,005 - INFO - RHS sum range: min=0.0000, max=0.0000
2026-01-20 17:20:27,132 - INFO - Shape of pseudo-inverse of A: torch.Size([384, 394])
2026-01-20 17:20:27,133 - INFO - A_pinv range: min=-26257.8496, max=28558.1328
2026-01-20 17:20:27,133 - INFO - Shape of reconstructed z: torch.Size([394, 384])
2026-01-20 17:20:27,133 - INFO - z_reconstructed range: min=0.0000, max=0.0000
2026-01-20 17:20:27,133 - INFO - --- Patch Embedding Reconstruction Results ---
2026-01-20 17:20:27,133 - INFO - Original embedding shape: torch.Size([2, 197, 384])
2026-01-20 17:20:27,133 - INFO - Reconstructed embedding shape: torch.Size([2, 197, 384])
2026-01-20 17:20:27,152 - INFO - Reconstruction error: 191.25515747070312
2026-01-20 17:20:27,152 - INFO - --- Embedding Visualization ---
2026-01-20 17:20:27,152 - INFO - Original embedding norm shape: (196,)
2026-01-20 17:20:27,152 - INFO - Reconstructed embedding norm shape: (196,)
2026-01-20 17:20:27,367 - INFO - Saved embedding visualization to embedding_visualization.png
2026-01-20 17:20:27,367 - INFO - --- Image Patch Reconstruction ---
2026-01-20 17:20:27,367 - INFO - Shape of positional embedding: torch.Size([1, 197, 384])
2026-01-20 17:20:27,367 - INFO - Range of positional embedding: min=-0.0913, max=0.0961
2026-01-20 17:20:27,367 - INFO - Shape of patch embeddings (z_patch): torch.Size([2, 196, 384])
2026-01-20 17:20:27,368 - INFO - Range of patch embeddings (z_patch): min=-2.8071, max=3.3413
2026-01-20 17:20:27,392 - INFO - Shape of pseudo-inverse of projection matrix: torch.Size([384, 768])
2026-01-20 17:20:27,392 - INFO - Shape of flattened reconstructed patches: torch.Size([2, 196, 768])
2026-01-20 17:20:27,392 - INFO - Reconstruction error for the first patch: 13.416234016418457
2026-01-20 17:20:27,393 - INFO - Shape of original patch: torch.Size([3, 16, 16])
2026-01-20 17:20:27,393 - INFO - Shape of reconstructed patch: torch.Size([3, 16, 16])
2026-01-20 17:20:27,393 - INFO - --- Full Image Reconstruction Visualization ---
